# –ó–ª–æ–µ –ø–∏—Å—å–º–æ ‚Äî Telegram-–±–æ—Ç (aiogram v3)

## –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
1) –°–æ–∑–¥–∞–π .env –Ω–∞ –æ—Å–Ω–æ–≤–µ .env.example
2) –£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `pip install -r bot/requirements.txt`
3) –ó–∞–ø—É—Å–∫: `cd bot && python -m app.main`

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã –Ω–∞–ø–∏—Å–∞–Ω–∏—è –ø–∏—Å–µ–º

### –û–±–∑–æ—Ä
–°–∏—Å—Ç–µ–º–∞ –Ω–∞–ø–∏—Å–∞–Ω–∏—è –ø–∏—Å–µ–º —Å–æ—Å—Ç–æ–∏—Ç –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

### –ü–æ—Ä—è–¥–æ–∫ —Ä–æ—É—Ç–µ—Ä–æ–≤ (–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û!)
–ü–æ—Ä—è–¥–æ–∫ –≤–∫–ª—é—á–µ–Ω–∏—è —Ä–æ—É—Ç–µ—Ä–æ–≤ –≤ `main.py` –∏–º–µ–µ—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:

```python
dp.include_router(admin_router)      # 1. –ê–¥–º–∏–Ω—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ - –ü–ï–†–í–´–ô!
dp.include_router(start_router)      # 2. –ö–æ–º–∞–Ω–¥—ã /start, /help, /cancel
dp.include_router(bind_router)       # 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ start payload
dp.include_router(write_router)      # 4. –ù–∞–ø–∏—Å–∞–Ω–∏–µ –ø–∏—Å–µ–º - –î–û–õ–ñ–ï–ù –ë–´–¢–¨ –ü–ï–†–ï–î relay_router!
dp.include_router(relay_router)      # 5. /end –∫–æ–º–∞–Ω–¥–∞ –∏ —Ä–µ–ª–µ–∏
dp.include_router(channel_router)    # 6. Callback –∫–Ω–æ–ø–∫–∏ –∫–∞–Ω–∞–ª–æ–≤
dp.include_router(auto_detect_router) # 7. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –∫–∞–Ω–∞–ª–æ–≤
dp.include_router(debug_router)      # 8. –û—Ç–ª–∞–¥–æ—á–Ω—ã–π —Ä–æ—É—Ç–µ—Ä - –ø–æ—Å–ª–µ–¥–Ω–∏–π
dp.include_router(direct_write_router) # 9. –ü—Ä—è–º–æ–µ –Ω–∞–ø–∏—Å–∞–Ω–∏–µ –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
```

**–í–ê–ñ–ù–û:** `write_router` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ü–ï–†–ï–î `relay_router`, –∏–Ω–∞—á–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ `pipe` –≤ `relay_router` –±—É–¥–µ—Ç –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞—Ç—å –≤—Å–µ —Ç–µ–∫—Å—Ç–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è.

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã –Ω–∞–ø–∏—Å–∞–Ω–∏—è –ø–∏—Å–µ–º

#### 1. Write Router (`app/features/write/router.py`)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Å–Ω–æ–≤–Ω–æ–π —Ä–æ—É—Ç–µ—Ä –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –Ω–∞–ø–∏—Å–∞–Ω–∏—è –ø–∏—Å–µ–º

**–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏:**
- `on_write_button` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏ "‚úçÔ∏è –ù–∞–ø–∏—Å–∞—Ç—å –ø–∏—Å—å–º–æ"
- `on_text_input` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ `INPUT_TEXT`
- `on_auto_text_input` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- TTL –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ - –≤—ã–±–æ—Ä –≤—Ä–µ–º–µ–Ω–∏ –∂–∏–∑–Ω–∏ –ø–æ—Å—Ç–∞
- Callback –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ - –æ—Ç–ø—Ä–∞–≤–∫–∞, –æ—Ç–º–µ–Ω–∞, —É–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–Ω–æ–≤–∏–∫–æ–≤

**–§–∏–ª—å—Ç—Ä—ã:**
```python
# –ö–Ω–æ–ø–∫–∞ –Ω–∞–ø–∏—Å–∞–Ω–∏—è –ø–∏—Å—å–º–∞
router.message.register(on_write_button, F.text == "‚úçÔ∏è –ù–∞–ø–∏—Å–∞—Ç—å –ø–∏—Å—å–º–æ")

# –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ INPUT_TEXT
router.message.register(on_text_input, StateFilter(WriteStates.INPUT_TEXT))

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞ (—Å –∫–∞—Å—Ç–æ–º–Ω—ã–º —Ñ–∏–ª—å—Ç—Ä–æ–º)
router.message.register(on_auto_text_input, auto_text_filter)
```

**–ö–∞—Å—Ç–æ–º–Ω—ã–π —Ñ–∏–ª—å—Ç—Ä `auto_text_filter`:**
```python
async def auto_text_filter(message, state: FSMContext):
    # –ò—Å–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫–∏
    if message.text and any(message.text.startswith(prefix) for prefix in ["‚úçÔ∏è", "‚öôÔ∏è", "üìä", "üìå", "üîÑ", "üõ°Ô∏è"]):
        return False
    
    # –ò—Å–∫–ª—é—á–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ INPUT_TEXT (–æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è on_text_input)
    current_state = await state.get_state()
    if current_state == WriteStates.INPUT_TEXT:
        return False
    
    return True
```

#### 2. Write Button Handler (`app/features/write/action_write_button.py`)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏ "‚úçÔ∏è –ù–∞–ø–∏—Å–∞—Ç—å –ø–∏—Å—å–º–æ"

**–§—É–Ω–∫—Ü–∏—è:** `on_write_button(m, state, active_mailbox_id, **kwargs)`

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
1. –û—á–∏—â–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ—Å—Ç–ø–∏–Ω–∞ (–µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤ –Ω–µ–º –Ω–∞—Ö–æ–¥–∏—Ç—Å—è)
2. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç FSM —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ `WriteStates.INPUT_TEXT`
3. –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–µ –¥–ª—è –≤–≤–æ–¥–∞ —Ç–µ–∫—Å—Ç–∞
4. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É —Å –ø–æ–¥—Å–∫–∞–∑–∫–∞–º–∏

#### 3. Text Input Handler (`app/features/write/state_input_text.py`)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞, –≤–≤–µ–¥–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ `INPUT_TEXT`

**–§—É–Ω–∫—Ü–∏—è:** `on_text_input(m, state, db, tz, active_mailbox_id)`

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
1. –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Ç–µ–∫—Å—Ç (–¥–ª–∏–Ω–∞, –ø—É—Å—Ç–æ—Ç–∞)
2. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ø—Å–µ–≤–¥–æ–Ω–∏–º –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
3. –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–µ–∫—Å—Ç –≤ FSM –¥–∞–Ω–Ω—ã–µ
4. –ü–µ—Ä–µ–≤–æ–¥–∏—Ç –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–µ `WriteStates.CHOOSE_TTL`
5. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–ª–∞–≤–∏–∞—Ç—É—Ä—É –≤—ã–±–æ—Ä–∞ –≤—Ä–µ–º–µ–Ω–∏ –∂–∏–∑–Ω–∏ –ø–æ—Å—Ç–∞

#### 4. Auto Text Handler (`app/features/write/auto_text_handler.py`)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞ –¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–Ω–µ –∞–¥–º–∏–Ω–æ–≤)

**–§—É–Ω–∫—Ü–∏—è:** `on_auto_text_input(m, state, db, active_mailbox_id, tz)`

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∞–¥–º–∏–Ω
2. –ï—Å–ª–∏ –∞–¥–º–∏–Ω –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ `INPUT_TEXT` - –ù–ï –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ
3. –î–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—á–∏–Ω–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –Ω–∞–ø–∏—Å–∞–Ω–∏—è –ø–∏—Å—å–º–∞

#### 5. Relay Router (`app/features/relay/router.py`)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ —Ä–µ–ª–µ—è –∏ –ø–µ—Ä–µ—Ö–≤–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è —Ä–µ–ª–µ—è

**–û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏:**
- `cmd_end` - –∫–æ–º–∞–Ω–¥–∞ `/end`
- `pipe` - –ø–µ—Ä–µ—Ö–≤–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏–π –¥–ª—è —Ä–µ–ª–µ—è

**–í–ê–ñ–ù–û:** `pipe` –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–º–µ–µ—Ç —Ñ–∏–ª—å—Ç—Ä, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–∫–ª—é—á–∞–µ—Ç –∫–Ω–æ–ø–∫–∏:
```python
router.message.register(pipe, ~F.text.startswith("‚úçÔ∏è") & ~F.text.startswith("‚öôÔ∏è") & ...)
```

#### 6. Direct Write Router (`app/main.py`)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä—è–º–æ–µ –Ω–∞–ø–∏—Å–∞–Ω–∏–µ –ø–∏—Å–µ–º –æ–±—ã—á–Ω—ã–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –±–µ–∑ –∫–Ω–æ–ø–æ–∫

**–§–∏–ª—å—Ç—Ä:** `not_in_fsm_filter` - –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ù–ï –≤ FSM —Å–æ—Å—Ç–æ—è–Ω–∏–∏

### FSM –°–æ—Å—Ç–æ—è–Ω–∏—è (`app/fsm/write_states.py`)

```python
class WriteStates(StatesGroup):
    INPUT_TEXT = State()      # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç –ø–∏—Å—å–º–∞
    CHOOSE_TTL = State()      # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏ –ø–æ—Å—Ç–∞
    PREVIEW = State()         # –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä –ø–∏—Å—å–º–∞
```

### –ü–æ—Ç–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

#### –î–ª—è –∞–¥–º–∏–Ω–æ–≤ (—Å –∫–Ω–æ–ø–∫–æ–π):
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç "‚úçÔ∏è –ù–∞–ø–∏—Å–∞—Ç—å –ø–∏—Å—å–º–æ"
2. `on_write_button` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ `INPUT_TEXT`
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç —Ç–µ–∫—Å—Ç
4. `on_text_input` –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–µ–∫—Å—Ç, –ø–µ—Ä–µ–≤–æ–¥–∏—Ç –≤ `CHOOSE_TTL`
5. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –≤—Ä–µ–º—è –∂–∏–∑–Ω–∏
6. –ü–∏—Å—å–º–æ –ø—É–±–ª–∏–∫—É–µ—Ç—Å—è

#### –î–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–±–µ–∑ –∫–Ω–æ–ø–∫–∏):
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—Ä–æ—Å—Ç–æ –ø–∏—à–µ—Ç —Ç–µ–∫—Å—Ç
2. `on_auto_text_input` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –Ω–∞—á–∏–Ω–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å
3. –î–∞–ª–µ–µ –∫–∞–∫ —É –∞–¥–º–∏–Ω–æ–≤

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –º–æ–º–µ–Ω—Ç—ã

#### 1. –ü–æ—Ä—è–¥–æ–∫ —Ä–æ—É—Ç–µ—Ä–æ–≤
- `write_router` –î–û–õ–ñ–ï–ù –±—ã—Ç—å –ü–ï–†–ï–î `relay_router`
- –ò–Ω–∞—á–µ `pipe` –≤ `relay_router` –ø–µ—Ä–µ—Ö–≤–∞—Ç–∏—Ç –≤—Å–µ —Å–æ–æ–±—â–µ–Ω–∏—è

#### 2. –§–∏–ª—å—Ç—Ä—ã
- `auto_text_filter` –∏—Å–∫–ª—é—á–∞–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ `INPUT_TEXT`
- `pipe` –∏—Å–∫–ª—é—á–∞–µ—Ç –∫–Ω–æ–ø–∫–∏
- `not_in_fsm_filter` –∏—Å–∫–ª—é—á–∞–µ—Ç FSM —Å–æ—Å—Ç–æ—è–Ω–∏—è

#### 3. –û–±—Ä–∞–±–æ—Ç–∫–∞ –∞–¥–º–∏–Ω–æ–≤
- –ê–¥–º–∏–Ω—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∫–Ω–æ–ø–∫–∏
- `on_auto_text_input` –ù–ï –ø–µ—Ä–µ—Ö–≤–∞—Ç—ã–≤–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –∞–¥–º–∏–Ω–æ–≤ –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ `INPUT_TEXT`

### –û—Ç–ª–∞–¥–∫–∞

–ï—Å–ª–∏ –∫–Ω–æ–ø–∫–∞ "‚úçÔ∏è –ù–∞–ø–∏—Å–∞—Ç—å –ø–∏—Å—å–º–æ" –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Ä—è–¥–æ–∫ —Ä–æ—É—Ç–µ—Ä–æ–≤** - `write_router` –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ü–ï–†–ï–î `relay_router`
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã** - —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –Ω–µ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏** - –∏—â–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ FSM —Å–æ—Å—Ç–æ—è–Ω–∏—è** - —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### –§–∞–π–ª—ã —Å–∏—Å—Ç–µ–º—ã

```
app/features/write/
‚îú‚îÄ‚îÄ router.py              # –û—Å–Ω–æ–≤–Ω–æ–π —Ä–æ—É—Ç–µ—Ä
‚îú‚îÄ‚îÄ action_write_button.py # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏
‚îú‚îÄ‚îÄ state_input_text.py    # –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–∞
‚îú‚îÄ‚îÄ auto_text_handler.py   # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
‚îú‚îÄ‚îÄ ttl_handlers.py        # –û–±—Ä–∞–±–æ—Ç–∫–∞ TTL
‚îî‚îÄ‚îÄ action_*.py           # –î—Ä—É–≥–∏–µ –¥–µ–π—Å—Ç–≤–∏—è

app/fsm/
‚îî‚îÄ‚îÄ write_states.py        # FSM —Å–æ—Å—Ç–æ—è–Ω–∏—è

app/main.py                # –ü–æ—Ä—è–¥–æ–∫ —Ä–æ—É—Ç–µ—Ä–æ–≤
```
